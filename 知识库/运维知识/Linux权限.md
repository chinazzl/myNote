Ubuntu（以及其他类 Unix 系统）的文件和目录权限是其安全模型的核心部分。理解这些权限对于管理系统和保护数据至关重要。

权限系统基于 **用户类型** 和 **权限类型**。

---

### 1. 用户类型 (Who)

每个文件或目录有三类用户可以对其进行操作：

*   **`u` (User / Owner)**：文件或目录的 **所有者**。通常是创建该文件的用户。
*   **`g` (Group)**：文件或目录的 **所属组** 中的成员。一个文件或目录可以属于一个特定的用户组，所有属于这个组的用户都会继承组的权限。
*   **`o` (Others)**：**其他用户**，即不属于所有者且不属于所属组的任何其他用户。
*   **`a` (All)**：指代上述所有三类用户（`u`, `g`, `o`）。在设置权限时使用，表示对所有用户类型都应用相同的权限。

---

### 2. 权限类型 (What)

对于文件和目录，有三种基本权限：

*   **`r` (Read / 读取)**：
    *   **对于文件**：允许查看文件内容。
    *   **对于目录**：允许列出目录中的文件和子目录（即 `ls` 命令）。
*   **`w` (Write / 写入)**：
    *   **对于文件**：允许修改、编辑或删除文件内容。
    *   **对于目录**：允许在目录中创建、删除、重命名文件和子目录（但删除文件还需要对文件本身有写权限）。
*   **`x` (Execute / 执行)**：
    *   **对于文件**：允许将文件作为程序运行（例如 Shell 脚本、二进制程序）。
    *   **对于目录**：允许进入该目录（即 `cd` 命令）。

---

### 3. 权限表示方法

权限可以用两种方式表示：**符号模式** 和 **数字模式**。

#### 3.1 符号模式 (Symbolic Mode)

当你使用 `ls -l` 命令时，会看到像 `drwxrwxr-x` 这样的权限字符串。

*   **第一个字符**：表示文件类型。
    *   `-`：普通文件
    *   `d`：目录
    *   `l`：符号链接
    *   `b`：块设备
    *   `c`：字符设备
    *   `p`：命名管道 (pipe)
    *   `s`：socket
*   **接下来的九个字符**：分为三组，每组三个字符，分别对应 **所有者**、**所属组** 和 **其他用户** 的权限。
    *   第一组（2-4位）：所有者权限 (rwx)
    *   第二组（5-7位）：所属组权限 (rwx)
    *   第三组（8-10位）：其他用户权限 (rwx)

**示例：`drwxrwxr-x`**

*   `d`: 这是一个目录。
*   `rwx`: 所有者拥有读、写、执行权限。
*   `rwx`: 所属组拥有读、写、执行权限。
*   `r-x`: 其他用户拥有读、执行权限，但没有写权限。

**特殊权限位 (Sticky Bit, SUID, SGID)**

在某些情况下，你可能会看到在 `rwx` 位置出现 `s` 或 `t`（通常是在 `x` 的位置，如果是大写则表示没有执行权限）：

*   **SUID (Set User ID)**：在所有者执行位 (`x`) 上显示为 `s`。
    *   **对于文件**：当文件被执行时，它会以文件所有者的权限运行，而不是执行者的权限。这常用于需要特殊权限的程序（如 `passwd` 命令，允许普通用户修改 `/etc/shadow` 文件，因为它以 root 权限运行）。
*   **SGID (Set Group ID)**：在所属组执行位 (`x`) 上显示为 `s`。
    *   **对于文件**：当文件被执行时，它会以文件所属组的权限运行。
    *   **对于目录**：在该目录下创建的新文件或目录，会自动继承该目录的组。
*   **Sticky Bit (粘滞位)**：在其他用户执行位 (`x`) 上显示为 `t`。
    *   **对于目录**：在该目录下，只有文件或目录的所有者或 root 用户才能删除或重命名文件（即使其他用户对该目录有写权限）。这常用于共享目录，如 `/tmp`。

#### 3.2 数字模式 (Octal Mode / Numeric Mode)

每种权限都可以用一个数字表示：

*   **`r` (Read)** = 4
*   **`w` (Write)** = 2
*   **`x` (Execute)** = 1
*   **`-` (No Permission)** = 0

将每组权限的数字相加，得到一个三位八进制数。

**计算方法：**

*   **所有者权限** = (r 的值) + (w 的值) + (x 的值)
*   **所属组权限** = (r 的值) + (w 的值) + (x 的值)
*   **其他用户权限** = (r 的值) + (w 的值) + (x 的值)

**示例：`drwxrwxr-x` (对应数字权限 775)**

*   **所有者**：`rwx` = 4 + 2 + 1 = 7
*   **所属组**：`rwx` = 4 + 2 + 1 = 7
*   **其他用户**：`r-x` = 4 + 0 + 1 = 5

所以，`drwxrwxr-x` 的数字模式表示就是 `775`。

**常见权限组合：**

*   **777** (`rwxrwxrwx`): 所有人都有读、写、执行权限（权限过于开放，不推荐用于生产环境）。
*   **755** (`rwxr-xr-x`): 所有者有读、写、执行，组用户和其他用户只有读和执行权限（常见于可执行文件和目录）。
*   **644** (`rw-r--r--`): 所有者有读、写权限，组用户和其他用户只有读权限（常见于普通文件）。

---

### 4. `chmod` 命令

使用 `chmod` 命令来修改文件或目录的权限。

#### 4.1 使用数字模式 (推荐)

```bash
chmod 755 myfile.sh  # 给myfile.sh设置rwxr-xr-x权限
chmod 644 mydocument.txt # 给mydocument.txt设置rw-r--r--权限
```

#### 4.2 使用符号模式

*   **`u/g/o/a`**: 用户类型
*   **`+`**: 添加权限
*   **`-`**: 移除权限
*   **`=`**: 精确设置权限（覆盖原有权限）
*   **`r/w/x`**: 权限类型

**示例：**

```bash
chmod u+x myfile.sh      # 给所有者添加执行权限
chmod go-w mydocument.txt # 移除组用户和其他用户的写权限
chmod a=rwx myfolder     # 设置所有用户都有读写执行权限 (不推荐)
chmod u=rw,g=r,o= myfile.txt # 设置所有者rw，组r，其他人无权限
```

#### 4.3 递归修改权限

使用 `-R` 选项可以递归地修改目录及其内容的权限：

```bash
chmod -R 755 my_directory/
```

---

### 5. `chown` 和 `chgrp` 命令

除了权限，文件和目录还有所有者和所属组：

*   **`chown user:group file/directory`**：改变文件或目录的所有者和所属组。
    ```bash
    chown newuser:newgroup myfile.txt
    ```
*   **`chown user file/directory`**：只改变文件或目录的所有者。
    ```bash
    chown newuser myfile.txt
    ```
*   **`chgrp group file/directory`**：只改变文件或目录的所属组。
    ```bash
    chgrp newgroup myfile.txt
    ```

理解这些权限概念对于在 Ubuntu 系统上进行文件操作、脚本执行、服务配置和安全管理都至关重要。